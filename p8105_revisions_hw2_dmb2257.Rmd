---
title: "p8105_revisions_hw2_dmb2257"
author: "Diane Benites"
date: "2025-11-30"
output: github_document
---
# Homework 2 Revisions
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Loads Necessary Packages
```{r}
library(tidyverse)
library(janitor)
library(readxl)
```


## Problem 1

This code chunk loads the unemployment dataframe  and cleans the names. It selects the needed columns and mutates the months to the full name. 
```{r}
unemployment_df = 
  read_csv(file = "./unemployment.csv")|>
  janitor::clean_names() |>
  
  select(year, jan, feb, mar, apr, may, jun, jul, aug, sep, oct, nov, dec) |>
  
  pivot_longer(
    jan:dec, 
    names_to = "month",
    values_to = "percentages") |>
    
  mutate(
    month = 
      case_match(
       month,
       "jan" ~ "January",
       "feb" ~ "February",
       "mar" ~ "March",
       "apr" ~ "April",
       "may" ~ "May",
       "jun" ~ "June",
       "jul" ~ "July",
       "aug" ~ "August",
       "sep" ~ "September",
       "oct" ~ "October",
       "nov" ~ "November",
       "dec" ~ "December"),
     month = as.factor(month))

```

This code chunk imports the polsmonth data. It separates the date into year, month and date and renames the numeric value of the month to the full month name. It also selects all variables except for day, prez_gop and prez_dem. It also filters the data to only include the points that were yes fo dem or gop.
```{r}
polsmonth_df = 
  read_csv(file = "./pols-month.csv")|>

  janitor::clean_names() |>
  
  separate(mon, into = c("year", "month", "day")) |>

  mutate(
    month = 
      case_match(
       month,
       "01" ~ "January",
       "02" ~ "February",
       "03" ~ "March",
       "04" ~ "April",
       "05" ~ "May",
       "06" ~ "June",
       "07" ~ "July",
       "08" ~ "August",
       "09" ~ "September",
       "10" ~ "October",
       "11" ~ "November",
       "12" ~ "December"),
     month = as.factor(month)) |>
    select(year, month, prez_gop, prez_dem, gov_gop, gov_dem, sen_gop, sen_dem, rep_gop, rep_dem) |>
    
  pivot_longer(
    prez_gop:prez_dem,
    names_to = "president") |>
    
  mutate(
    president = case_match(
      president,
      "prez_gop" ~ "gop",
      "prez_dem" ~ "dem")) |>
    
  filter(value == 1)
```


The loads the dataset snp and separates the sate into month, day and year. It mutates the numeric month to the full month name. 
```{r}
snp_df = 
  read_csv(file = "./snp.csv")|>
janitor::clean_names() |>

separate(date, into = c("month", "day", "year")) |>

  mutate(
    month = 
      case_match(
       month,
       "01" ~ "January",
       "02" ~ "February",
       "03" ~ "March",
       "04" ~ "April",
       "05" ~ "May",
       "06" ~ "June",
       "07" ~ "July",
       "08" ~ "August",
       "09" ~ "September",
       "10" ~ "October",
       "11" ~ "November",
       "12" ~ "December"),
     month = as.factor(month)) |>
    relocate(year, month, close)|>
    select(-day)
```

The polsmonth dataset contains observations regarding the political parties of politicians. The "presidents" variable identifies the president during that given time as democrat or republican, demonstrated by value 1. The unemployment dataset contains observations regarding the percentage of unemployment during a given month each year. There were originally 13 variables, one for year and one for each of the 12 months. The months variables and values were consolidated into one month column and one percentages column, respectively. The snp dataset contains observations with 2 variables, the date of the observation and the closing S&P value at the given date. The date separated into month, date, and year, and the numeric values for month were renamed to the full month name. 


## Problem 2
This imports the Mr. trashwheel data sheet and cleans the names. It omits rows that do not include dumpster specific data, computes the appropriate value for homes_powered, and rounds the number of sports balls to the nearest integer. It also creates a new variable "trashwheel" with the value "mr" to identify this trashwheel when I combine the datasets.
```{r}
mr_trashwheel_df <-
  read_excel("./202409 Trash Wheel Collection Data.xlsx", range = "Mr. Trash Wheel!A2:N655")|>
  janitor::clean_names()|>
  drop_na(dumpster)|>
  mutate(homes_powered = weight_tons*500/30,
        sports_balls = round(sports_balls),
        sports_balls = as.integer(sports_balls),
         year = as.numeric(year),
        trashwheel = "mr")

```


This imports and cleans the names in the Professor Trash Wheel data sheet.It omits rows that do not include dumpster specific data. It also creates a new variable "trashwheel" with the value "professor" to identify this trashwheel when I combine the datasets.
```{r}
prof_trashwheel_df <-
  read_excel("./202409 Trash Wheel Collection Data.xlsx", range = "Professor Trash Wheel!A2:M123")|>
  janitor::clean_names()|>
  drop_na(dumpster)|>
  mutate(trashwheel = "professor")|>
  mutate(weight_tons = as.numeric(weight_tons))

```


This imports and cleans the names in the Gwynnda Trash Wheeldata sheet. It omits rows that do not include dumpster specific data. It also creates a new variable "trashwheel" with the value "gwynnda" to identify this trashwheel when I combine the datasets.
```{r}
gwynnda_trashwheel_df <-
  read_excel("./202409 Trash Wheel Collection Data.xlsx", range ="Gwynnda Trash Wheel!A2:L266")|>
  janitor::clean_names()|>
  drop_na(dumpster)|>
  mutate(trashwheel = "gwynnda")
```

This combines the datasets into one tidy dataframe. 
```{r}
tidy_trashwheel_df = 
  bind_rows(mr_trashwheel_df, prof_trashwheel_df, gwynnda_trashwheel_df)

```

This code chunk computes the total weight of trash collected by each trash wheel by computing the sum of weight_tons. It also computes the sum of cigarette butts collected after filtering for June 2022. 
```{r}
tidy_trashwheel_df|>
  group_by(trashwheel)|>
  drop_na(weight_tons)|>
  summarize(
    total_trash = sum(weight_tons, na.rm = FALSE))

tidy_trashwheel_df|>
  filter(month == "June")|>
  filter(year == "2022")|>
  group_by(trashwheel)|>
  summarize(cigs = sum(cigarette_butts))
  
```

The resulting dataset contains 1033 observations of 15 variables. Key variables include the trash wheel variable, which identifies the trashwheel. Another key variable is the date the trash was collected and the weight in tons of the trash collected. The homes powered variable was computed using the weight in tons variable. The weight of trash collected was multiplied by 500 kilowatts of electricity divided by 30 kilowatts of electricity used per home, to determine the number of homes powered based on the weight of trash collected by the dumpster.The total weight of trash collected by Professor Trash Wheel was 247 tons. In June 2022, 18120 total cigarette butts were collected by Gwynnda Trash Wheel.




## Problem 3
This imports and cleans the names to snakecase in the zip codes and zori data sets. It creates the variable "borough" for both of the data sets. It renames the county names to a consistent format under the borough variable.The zori dataset is cleaned to condense the dates and rental prices into two columns, and drop missing rental prices.
```{r}
zipcodes_tidy_df = 
    read_csv(file = "./Zip Codes.csv")|>
  janitor::clean_names()|>
  mutate(borough = county)|>
  mutate(
    borough = 
      case_match(
        borough,
        "Kings" ~"Brooklyn",
        "Bronx" ~ "Bronx",
        "New York" ~ "Manhattan",
        "Queens" ~ "Queens",
        "Richmond" ~ "Staten Island"))
   
zori_df = 
  read_csv(file =  "./Zip_zori_uc_sfrcondomfr_sm_month_NYC.csv")|>
  janitor::clean_names()|>
  select(-state_name)|>
  pivot_longer(
    x2015_01_31:x2024_08_31,
    names_to = "date",
    values_to = "rent_price")|>
  drop_na(rent_price)|>
    mutate(borough = county_name)|>
    mutate(
    borough = 
      case_match(
        borough,
        "Kings County" ~"Brooklyn",
        "Bronx County" ~ "Bronx",
        "New York County" ~ "Manhattan",
        "Queens County" ~ "Queens",
        "Richmond County" ~ "Staten Island"))

```


This code chunk creates a single datset with all the information contained in these files. 
```{r}
tidy_ny_df =
  left_join(zori_df, zipcodes_tidy_df)
```



